#include <avr/sleep.h> #include <avr/power.h> int pin2 = 2;//触摸开关 long previousMillis = 0; unsigned long currentMillis=0; long interval = 30000;   //一次开启后30后睡眠，时间较长是因为要保证能使猫粮漏入猫粮盆 #include <Servo.h> #define servo_pin A0 #define humanHotSensor 4 #include <SoftwareSerial.h> Servo myservo; bool humanHotState = false; void pin2Interrupt(void) { Serial.println("wake up!!!"); detachInterrupt(0); } void enterSleep(void) { attachInterrupt(0, pin2Interrupt, LOW); delay(1000); set_sleep_mode(SLEEP_MODE_PWR_DOWN); sleep_enable(); sleep_mode(); sleep_disable(); } void setup() { Serial.begin(9600); pinMode(pin2, INPUT); pinMode(humanHotSensor, INPUT); myservo.attach(servo_pin); } void loop() { currentMillis = millis(); Serial.print("Awake for "); Serial.print(currentMillis - previousMillis, DEC); Serial.println(" second"); delay(100); humanHotState = digitalRead(humanHotSensor); if (humanHotState) { Serial.println(humanHotState); myservo.write(90); delay(2000);myservo.write(0);delay(1000);delay(30000) } if(currentMillis - previousMillis > interval) { previousMillis = currentMillis; Serial.println("Entering sleep"); enterSleep(); } if(currentMillis<previousMillis) previousMillis=currentMillis=0;